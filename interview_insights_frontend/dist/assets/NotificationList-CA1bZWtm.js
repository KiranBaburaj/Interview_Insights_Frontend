import{r as f,A as c,_ as gr,f as E,j as e,i as M,a as fr,u as vr,b as B,aG as hr,aH as mr,aI as br}from"./index-DZZwBIMF.js";import{r as N}from"./ExitToApp-_kaibx0O.js";import{c as Or}from"./notificationWebSocket-LyXQ8B2b.js";import{a as xr,g as yr,s as L,u as _r,c as X,b as Cr,T as $r}from"./Box-L8YP_HMF.js";import{M as rr}from"./MenuItem-yJCxavGA.js";import{I as Y}from"./IconButton-CZIn7WCe.js";import{d as w}from"./List-CtAuu3yH.js";import{M as Pr}from"./TextField-_N8teEsA.js";import{S as Rr}from"./Snackbar-tcWgl1Rl.js";const or=o=>{const t=f.useRef({});return f.useEffect(()=>{t.current=o}),t.current};function jr(o){const{badgeContent:t,invisible:r=!1,max:i=99,showZero:n=!1}=o,d=or({badgeContent:t,max:i});let s=r;r===!1&&t===0&&!n&&(s=!0);const{badgeContent:l,max:u=i}=s?d:o,g=l&&Number(l)>u?`${u}+`:l;return{badgeContent:l,invisible:s,max:u,displayValue:g}}function zr(o){return yr("MuiBadge",o)}const v=xr("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),Br=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],W=10,H=4,Mr=o=>{const{color:t,anchorOrigin:r,invisible:i,overlap:n,variant:d,classes:s={}}=o,l={root:["root"],badge:["badge",d,i&&"invisible",`anchorOrigin${c(r.vertical)}${c(r.horizontal)}`,`anchorOrigin${c(r.vertical)}${c(r.horizontal)}${c(n)}`,`overlap${c(n)}`,t!=="default"&&`color${c(t)}`]};return Cr(l,zr,s)},Nr=L("span",{name:"MuiBadge",slot:"Root",overridesResolver:(o,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),kr=L("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(o,t)=>{const{ownerState:r}=o;return[t.badge,t[r.variant],t[`anchorOrigin${c(r.anchorOrigin.vertical)}${c(r.anchorOrigin.horizontal)}${c(r.overlap)}`],r.color!=="default"&&t[`color${c(r.color)}`],r.invisible&&t.invisible]}})(({theme:o})=>{var t;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:o.typography.fontFamily,fontWeight:o.typography.fontWeightMedium,fontSize:o.typography.pxToRem(12),minWidth:W*2,lineHeight:1,padding:"0 6px",height:W*2,borderRadius:W,zIndex:1,transition:o.transitions.create("transform",{easing:o.transitions.easing.easeInOut,duration:o.transitions.duration.enteringScreen}),variants:[...Object.keys(((t=o.vars)!=null?t:o).palette).filter(r=>{var i,n;return((i=o.vars)!=null?i:o).palette[r].main&&((n=o.vars)!=null?n:o).palette[r].contrastText}).map(r=>({props:{color:r},style:{backgroundColor:(o.vars||o).palette[r].main,color:(o.vars||o).palette[r].contrastText}})),{props:{variant:"dot"},style:{borderRadius:H,height:H*2,minWidth:H*2,padding:0}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${v.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${v.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${v.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${v.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${v.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${v.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${v.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${v.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:o.transitions.create("transform",{easing:o.transitions.easing.easeInOut,duration:o.transitions.duration.leavingScreen})}}]}}),Sr=f.forwardRef(function(t,r){var i,n,d,s,l,u;const g=_r({props:t,name:"MuiBadge"}),{anchorOrigin:_={vertical:"top",horizontal:"right"},className:C,component:m,components:b={},componentsProps:x={},children:k,overlap:$="rectangular",color:P="default",invisible:R=!1,max:a=99,badgeContent:p,slots:O,slotProps:h,showZero:j=!1,variant:y="standard"}=g,S=gr(g,Br),{badgeContent:z,invisible:er,max:nr,displayValue:ir}=jr({max:a,invisible:R,badgeContent:p,showZero:j}),sr=or({anchorOrigin:_,color:P,overlap:$,variant:y,badgeContent:p}),F=er||z==null&&y!=="dot",{color:lr=P,overlap:cr=$,anchorOrigin:pr=_,variant:Z=y}=F?sr:g,G=Z!=="dot"?ir:void 0,I=E({},g,{badgeContent:z,invisible:F,max:nr,displayValue:G,showZero:j,anchorOrigin:pr,color:lr,overlap:cr,variant:Z}),J=Mr(I),K=(i=(n=O==null?void 0:O.root)!=null?n:b.Root)!=null?i:Nr,Q=(d=(s=O==null?void 0:O.badge)!=null?s:b.Badge)!=null?d:kr,T=(l=h==null?void 0:h.root)!=null?l:x.root,D=(u=h==null?void 0:h.badge)!=null?u:x.badge,dr=w({elementType:K,externalSlotProps:T,externalForwardedProps:S,additionalProps:{ref:r,as:m},ownerState:I,className:X(T==null?void 0:T.className,J.root,C)}),ur=w({elementType:Q,externalSlotProps:D,ownerState:I,className:X(J.badge,D==null?void 0:D.className)});return e.jsxs(K,E({},dr,{children:[k,e.jsx(Q,E({},ur,{children:G}))]}))});var A={},Ir=M;Object.defineProperty(A,"__esModule",{value:!0});var Tr=A.default=void 0,Dr=Ir(N()),Er=e;Tr=A.default=(0,Dr.default)((0,Er.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");var U={},Wr=M;Object.defineProperty(U,"__esModule",{value:!0});var Hr=U.default=void 0,Lr=Wr(N()),Ar=e;Hr=U.default=(0,Lr.default)((0,Ar.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu");var q={},Ur=M;Object.defineProperty(q,"__esModule",{value:!0});var ar=q.default=void 0,qr=Ur(N()),Vr=e;ar=q.default=(0,qr.default)((0,Vr.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");var V={},Fr=M;Object.defineProperty(V,"__esModule",{value:!0});var tr=V.default=void 0,Zr=Fr(N()),Gr=e;tr=V.default=(0,Zr.default)((0,Gr.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications");const Jr=L(rr)(({theme:o,unread:t})=>({backgroundColor:t?o.palette.action.hover:o.palette.background.paper,color:t?o.palette.primary.main:o.palette.text.primary,fontWeight:t?"bold":"normal","&:hover":{backgroundColor:o.palette.action.selected}})),eo=()=>{const o=fr(),t=vr(),r=B(a=>a.notifications.notifications),[i,n]=f.useState(0),[d,s]=f.useState(null),[l,u]=f.useState(!1),[g,_]=f.useState(null),C=B(a=>a.auth.role),m=B(a=>a.auth.accessToken),b=B(a=>a.auth.userid);f.useEffect(()=>{if(m&&b)return t(hr(m)),Or(m,b,a=>{if(a.payload){const{id:p,message:O,is_read:h,user_id:j,notification_type:y,timestamp:S}=a.payload;t(mr({id:p,message:O,is_read:h,user:j,notification_type:y,created_at:S||a.payload.created_at})),h||n(z=>z+1),console.log("Notification received:",a.payload)}else console.warn("Unexpected notification format:",a)}),()=>{}},[t,m,b]),f.useEffect(()=>{const a=r.filter(p=>!p.is_read).length;n(a)},[r]);const x=(a,p)=>{p!=="clickaway"&&u(!1)},k=a=>{t(br(a.id)),_(a),u(!0),C==="jobseeker"?o("/chat"):C==="employer"&&o("/Employer/chat")},$=a=>{s(a.currentTarget),n(0)},P=()=>{s(null)},R=r.filter(a=>!a.is_read);return[...r].sort((a,p)=>new Date(p.created_at)-new Date(a.created_at)).slice(0,20),e.jsxs("div",{children:[e.jsx(Y,{size:"large","aria-label":"show notifications",color:"inherit",onClick:$,children:e.jsx(Sr,{badgeContent:i,color:"error",children:e.jsx(tr,{})})}),e.jsx(Pr,{anchorEl:d,open:!!d,onClose:P,PaperProps:{style:{backgroundColor:"#ffffff",color:"#333333"}},children:R.length>0?R.map(a=>e.jsx(Jr,{onClick:()=>k(a),unread:!a.is_read,children:e.jsx($r,{variant:"body2",noWrap:!0,children:a.message})},a.id)):e.jsx(rr,{disabled:!0,children:"No new notifications"})}),g&&e.jsx(Rr,{open:l,autoHideDuration:6e3,onClose:x,message:g.message,action:e.jsx(Y,{size:"small","aria-label":"close",color:"inherit",onClick:x,children:e.jsx(ar,{fontSize:"small"})})})]})};export{eo as N,Hr as a,Tr as d};
