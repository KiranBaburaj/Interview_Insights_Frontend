import{r as t,j as e,C as x}from"./index-Cj5dfuwC.js";import{C}from"./Container-9K4eZScU.js";import{B as d,T as s}from"./Box-CDH_ohIQ.js";import{T as c}from"./TextField-DhAF_aMU.js";import{B as g}from"./Button-Bu-51tHz.js";import{C as w}from"./CircularProgress-vrxrjlXB.js";import{L as f}from"./Link-Dc19CVaF.js";import{A as T}from"./Alert-E4sb2ZTz.js";import"./useThemeProps-CEwqd1NW.js";import"./List-Bx1nfZlu.js";import"./useSlot-BNlY2AKo.js";import"./IconButton-DOBjB5CW.js";const z=()=>{const[i,j]=t.useState(""),[m,P]=t.useState(""),[u,y]=t.useState(""),[l,p]=t.useState(1),[a,o]=t.useState(!1),[h,n]=t.useState(null),v=async()=>{o(!0),n(null);try{await x.post("/api/request-password-reset/",{email:i}),p(2)}catch(r){console.error("Error requesting OTP:",r),n("Failed to request OTP. Please try again.")}finally{o(!1)}},E=async()=>{o(!0),n(null);try{await x.post("/api/password-reset-confirm/",{email:i,otp:m,new_password:u}),p(3)}catch(r){console.error("Error resetting password:",r),n("Failed to reset password. Please try again.")}finally{o(!1)}};return e.jsx(C,{maxWidth:"sm",children:e.jsxs(d,{sx:{mt:4},children:[l===1&&e.jsxs(d,{component:"div",children:[e.jsx(s,{variant:"h4",align:"center",gutterBottom:!0,children:"Forgot Password"}),e.jsx(c,{margin:"normal",fullWidth:!0,id:"email",label:"Email Address",type:"email",value:i,onChange:r=>j(r.target.value),placeholder:"Enter your email"}),e.jsx(g,{variant:"contained",fullWidth:!0,sx:{mt:2},disabled:a,onClick:v,children:a?e.jsx(w,{size:24}):"Request OTP"}),e.jsxs(s,{variant:"body2",align:"center",sx:{mt:2},children:["Remembered your password? ",e.jsx(f,{href:"/login",children:"Log in here"})]})]}),l===2&&e.jsxs(d,{component:"div",children:[e.jsx(s,{variant:"h4",align:"center",gutterBottom:!0,children:"Enter OTP and New Password"}),e.jsx(c,{margin:"normal",fullWidth:!0,id:"otp",label:"OTP",type:"text",value:m,onChange:r=>P(r.target.value),placeholder:"Enter OTP"}),e.jsx(c,{margin:"normal",fullWidth:!0,id:"newPassword",label:"New Password",type:"password",value:u,onChange:r=>y(r.target.value),placeholder:"Enter new password"}),e.jsx(g,{variant:"contained",fullWidth:!0,sx:{mt:2},disabled:a,onClick:E,children:a?e.jsx(w,{size:24}):"Reset Password"}),e.jsxs(s,{variant:"body2",align:"center",sx:{mt:2},children:["Go back to ",e.jsx(f,{href:"/",children:"Home"})]})]}),l===3&&e.jsx(s,{variant:"h4",align:"center",gutterBottom:!0,children:"Password reset successful!"}),h&&e.jsx(T,{severity:"error",sx:{mt:2},children:h})]})})};export{z as default};
