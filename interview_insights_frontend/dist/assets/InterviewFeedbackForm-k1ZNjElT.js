import{ac as F,b as d,u as C,a as E,r as n,az as B,j as e,aB as D,aH as A}from"./index-bGYT25wZ.js";import{E as M}from"./EmployerNavbar-DVspZa2l.js";import{T as v,B as W}from"./Box-C7FEM3NL.js";import{C as P}from"./ListItemText-07Kah4MH.js";import{C as T}from"./Container-dy5BwHIB.js";import{G as a}from"./Grid-DmF7rOvg.js";import{P as H,B as L}from"./List-D74dhkXP.js";import{T as u}from"./TextField-BYB5Qg8x.js";import{M as G}from"./MenuItem-B90v413L.js";import{S as g}from"./Snackbar-BKXculAC.js";import{A as j}from"./Alert-ChBBo_zY.js";import"./ExitToApp-BEgo4Djy.js";import"./Business-BGl9iX9Q.js";import"./NotificationList-yhGo_VeS.js";import"./notificationWebSocket-9HsNs1-H.js";import"./IconButton-DJYvWjlu.js";import"./useMediaQuery-Cb1ErGgz.js";import"./useThemeProps-kGATZQtu.js";import"./Divider-DEgvekp5.js";import"./dividerClasses-HgKa27Ig.js";import"./Avatar-CBFG6Ddh.js";import"./useSlot-CNXxXkOI.js";import"./ListItem-qaxTY3Ea.js";import"./listItemTextClasses-Cm7N65T6.js";const me=()=>{const{interviewId:w}=F(),s=parseInt(w,10),k=d(t=>t.interviews);console.log(k);const m=d(t=>t.applicants.job_Id);console.log(m);const o=C(),_=E(),{currentFeedback:r,status:N,error:q}=d(t=>t.interviews),[i,p]=n.useState({score:0,feedback:"",stage:"",interview_schedule:s||""}),[h,f]=n.useState(""),[x,c]=n.useState(""),[y,b]=n.useState(!0);n.useEffect(()=>{s&&(console.log("Fetching feedback for interviewId:",s),o(B(s)).then(()=>{console.log("Feedback fetched successfully"),b(!1)}).catch(t=>{console.error("Error fetching feedback:",t),b(!1)}))},[o,s]),n.useEffect(()=>{console.log("Current feedback:",r),console.log("Interview ID:",s),r&&r.interview_schedule===s&&(console.log("Setting feedback data"),p({score:r.score||0,feedback:r.feedback||"",stage:r.stage||"",interview_schedule:r.interview_schedule||s}))},[r,s]);const l=t=>{p({...i,[t.target.name]:t.target.value})},I=async t=>{if(t.preventDefault(),f(""),c(""),!i.interview_schedule){c("Interview schedule is required.");return}try{(r&&r.id?await o(D({id:r.id,feedbackData:i})):await o(A({interviewId:i.interview_schedule,feedbackData:i}))).type.endsWith("/fulfilled")?(f("Feedback submitted successfully!"),_(`/EmployerJobapplicants/${m}`)):c("An error occurred while submitting feedback.")}catch{c("An unexpected error occurred.")}};return y?e.jsx(v,{children:"Loading..."}):e.jsxs(W,{sx:{display:"flex"},children:[e.jsx(P,{}),e.jsx(M,{}),e.jsx(T,{maxWidth:"lg",children:e.jsx(a,{container:!0,spacing:4,children:e.jsx(a,{item:!0,xs:12,children:e.jsxs(H,{elevation:3,sx:{padding:3,mt:5},children:[e.jsx(v,{variant:"h5",component:"h2",gutterBottom:!0,children:"Submit Interview Feedback"}),e.jsx("form",{onSubmit:I,children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,label:"Score (1-10)",type:"number",id:"score",name:"score",value:i.score,onChange:l,variant:"outlined",InputProps:{inputProps:{min:0,max:10}}})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,label:"Feedback",type:"text",id:"feedback",name:"feedback",value:i.feedback,onChange:l,variant:"outlined",multiline:!0,rows:4})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,label:"Interview Stage",id:"stage",name:"stage",select:!0,value:i.stage,onChange:l,variant:"outlined",children:["application_screening","phone_interview","technical_assessment","first_round_interview","second_round_interview","hr_interview","final_interview","job_offer","hired"].map(t=>e.jsx(G,{value:t,children:t.replace(/_/g," ").toUpperCase()},t))})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx("input",{type:"hidden",name:"interviewSchedule",value:i.interview_schedule}),e.jsx(L,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,children:"Submit Feedback"})]})]})}),x&&e.jsx(g,{open:!0,autoHideDuration:6e3,children:e.jsx(j,{severity:"error",children:x})}),h&&e.jsx(g,{open:!0,autoHideDuration:6e3,children:e.jsx(j,{severity:"success",children:h})})]})})})})]})};export{me as default};
