import{a9 as S,b as d,u as C,a as E,r as n,ax as D,j as e,az as B,aF as A}from"./index-DSnL7-iu.js";import{E as M}from"./EmployerNavbar-CwXgdYe4.js";import{T as v,B as W}from"./Box-C-1FhN2f.js";import{C as P}from"./ListItemText-DHGmZljv.js";import{C as T}from"./Container-DEkqFEjr.js";import{G as a}from"./Grid-c2wW-2B7.js";import{P as L}from"./List-BwbNNtoy.js";import{T as u}from"./TextField-B9bqOITb.js";import{M as G}from"./MenuItem-C95VAytL.js";import{B as H}from"./Button-Dq6K9lQh.js";import{S as g}from"./Snackbar-Bi0FXNIN.js";import{A as j}from"./Alert-C0wi5gvV.js";import"./ExitToApp-D3F-RYbZ.js";import"./Business-vL0bk2FG.js";import"./NotificationList-Bl1vEY8m.js";import"./notificationWebSocket-DXIjSC-9.js";import"./IconButton-4pwRuVfJ.js";import"./useMediaQuery--xobtwY9.js";import"./useThemeProps-9kYSu9O9.js";import"./Divider-BP-rb56W.js";import"./dividerClasses-DFrms6Za.js";import"./Avatar-0ei4gyy9.js";import"./useSlot-BDGQsooM.js";import"./ListItem-BxQ4Xmtu.js";import"./listItemTextClasses-CmLW-qOz.js";const pe=()=>{const{interviewId:w}=S(),s=parseInt(w,10),k=d(t=>t.interviews);console.log(k);const m=d(t=>t.applicants.job_Id);console.log(m);const o=C(),_=E(),{currentFeedback:r,status:N,error:q}=d(t=>t.interviews),[i,p]=n.useState({score:0,feedback:"",stage:"",interview_schedule:s||""}),[h,f]=n.useState(""),[x,c]=n.useState(""),[y,b]=n.useState(!0);n.useEffect(()=>{s&&(console.log("Fetching feedback for interviewId:",s),o(D(s)).then(()=>{console.log("Feedback fetched successfully"),b(!1)}).catch(t=>{console.error("Error fetching feedback:",t),b(!1)}))},[o,s]),n.useEffect(()=>{console.log("Current feedback:",r),console.log("Interview ID:",s),r&&r.interview_schedule===s&&(console.log("Setting feedback data"),p({score:r.score||0,feedback:r.feedback||"",stage:r.stage||"",interview_schedule:r.interview_schedule||s}))},[r,s]);const l=t=>{p({...i,[t.target.name]:t.target.value})},F=async t=>{if(t.preventDefault(),f(""),c(""),!i.interview_schedule){c("Interview schedule is required.");return}try{(r&&r.id?await o(B({id:r.id,feedbackData:i})):await o(A({interviewId:i.interview_schedule,feedbackData:i}))).type.endsWith("/fulfilled")?(f("Feedback submitted successfully!"),_(`/EmployerJobapplicants/${m}`)):c("An error occurred while submitting feedback.")}catch{c("An unexpected error occurred.")}};return y?e.jsx(v,{children:"Loading..."}):e.jsxs(W,{sx:{display:"flex"},children:[e.jsx(P,{}),e.jsx(M,{}),e.jsx(T,{maxWidth:"lg",children:e.jsx(a,{container:!0,spacing:4,children:e.jsx(a,{item:!0,xs:12,children:e.jsxs(L,{elevation:3,sx:{padding:3,mt:5},children:[e.jsx(v,{variant:"h5",component:"h2",gutterBottom:!0,children:"Submit Interview Feedback"}),e.jsx("form",{onSubmit:F,children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,label:"Score (1-10)",type:"number",id:"score",name:"score",value:i.score,onChange:l,variant:"outlined",InputProps:{inputProps:{min:0,max:10}}})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,label:"Feedback",type:"text",id:"feedback",name:"feedback",value:i.feedback,onChange:l,variant:"outlined",multiline:!0,rows:4})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(u,{fullWidth:!0,label:"Interview Stage",id:"stage",name:"stage",select:!0,value:i.stage,onChange:l,variant:"outlined",children:["application_screening","phone_interview","technical_assessment","first_round_interview","second_round_interview","hr_interview","final_interview","job_offer","hired"].map(t=>e.jsx(G,{value:t,children:t.replace(/_/g," ").toUpperCase()},t))})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx("input",{type:"hidden",name:"interviewSchedule",value:i.interview_schedule}),e.jsx(H,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,children:"Submit Feedback"})]})]})}),x&&e.jsx(g,{open:!0,autoHideDuration:6e3,children:e.jsx(j,{severity:"error",children:x})}),h&&e.jsx(g,{open:!0,autoHideDuration:6e3,children:e.jsx(j,{severity:"success",children:h})})]})})})})]})};export{pe as default};
