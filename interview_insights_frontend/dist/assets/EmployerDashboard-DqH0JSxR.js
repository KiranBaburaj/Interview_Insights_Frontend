import{j as e,u as G,r as f,b as d,k as M,m as z,n as O,L as g}from"./index-UPAOvg_G.js";import{E as K}from"./EmployerNavbar-1KEjsPOv.js";import{d as r,L as W,A as q,D as H,P as Q,a as V,C as X,T as Y,b as Z}from"./AdapterDayjs-DZDbKUnB.js";import{d as ee,B as c,T as o}from"./Box-BWDG5rNi.js";import{C as te}from"./CircularProgress-B7FC7rbV.js";import{C as se,L as y}from"./ListItemText-NU8dwKLc.js";import{T as oe}from"./ExitToApp-CkJU4z1a.js";import{C as re}from"./CalendarToday-Ce49isHw.js";import{P as p,L as b}from"./List-GWNcwQbp.js";import{L as v}from"./ListItem-BXTzSaQX.js";import{I as A}from"./IconButton-BStxGFSI.js";import{A as ie}from"./Avatar-CS5raCN_.js";import{G as C}from"./Grid-C4mvyxN6.js";import"./Business-jwHY4V5W.js";import"./NotificationList-YuIR9vQG.js";import"./notificationWebSocket-BXbQgH3j.js";import"./MenuItem-Dt2xTNEu.js";import"./dividerClasses-CidYI2B0.js";import"./listItemTextClasses-Dp4iva8S.js";import"./TextField-Btq3qCLk.js";import"./Snackbar-DMjJKLi-.js";import"./useMediaQuery-CLrKrbJU.js";import"./useThemeProps-Scof9SRk.js";import"./Divider-DuL92jII.js";import"./isBetween-BTixMsoP.js";import"./Stack-BrxQKT-c.js";import"./visuallyHidden-Dan1xhjv.js";import"./DialogContent-DemABcdC.js";import"./Chip-SM2CToGV.js";import"./useSlot-D2mK9hbB.js";const D=ee(e.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos"),S=["#0088FE","#00C49F","#FFBB28","#FF8042"],Te=()=>{const j=G(),[L,k]=f.useState(!1),[i,B]=f.useState([null,null]),{user:J}=d(t=>t.auth),{userid:F}=d(t=>t.auth),_=F;console.log(_);const u=d(M),$=d(t=>t.applicants.applicants),T=d(t=>t.jobs.status),E=d(t=>t.applicants.status),{full_name:R}=d(t=>t.auth);f.useEffect(()=>{j(z())},[j]),f.useEffect(()=>{u.length>0&&!L&&(u.forEach(t=>{j(O(t.id))}),k(!0))},[j,u,L]);const N=t=>{B(t)},x=u.filter(t=>{const s=r(t.posted_at);return t.employer==_&&(!i[0]||s.isAfter(r(i[0]).subtract(1,"day")))&&(!i[1]||s.isBefore(r(i[1]).add(1,"day")))});console.log(x),console.log($);const m=$.filter(t=>{const s=r(t.applied_at);return t.job_details.employer==_&&(!i[0]||s.isAfter(r(i[0]).subtract(1,"day")))&&(!i[1]||s.isBefore(r(i[1]).add(1,"day")))}),w=x.length,I=m.length,P=[{name:"Jobs Posted",value:w},{name:"Applications Received",value:I}];if(T==="loading"||E==="loading")return e.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(te,{})});const U=x.map(t=>{const s=m.filter(l=>l.job_seeker.myapplications.some(h=>h.job===t.id)),a=t.views_count||0,n=s.length;return{id:t.id,title:t.title,viewsCount:a,applicationsCount:n}});return e.jsx(W,{dateAdapter:q,children:e.jsxs(c,{sx:{display:"flex"},children:[e.jsx(se,{}),e.jsx(K,{}),e.jsxs(c,{component:"main",sx:{flexGrow:1,p:3,width:{sm:"calc(100% - 240px)"}},children:[e.jsx(oe,{}),e.jsxs(c,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsxs(o,{variant:"h4",component:"h1",children:["Welcome, ",J?R:"Employer"]}),e.jsxs(c,{display:"flex",alignItems:"center",children:[e.jsx(re,{}),e.jsx(H,{sx:{mx:2},startText:"Start",endText:"End",value:i,onChange:N})]})]}),e.jsxs(c,{display:"flex",justifyContent:"space-between",mb:3,children:[e.jsxs(p,{sx:{p:2,textAlign:"center",flex:1,mr:2},children:[e.jsx(o,{variant:"h6",children:"Total Jobs Posted"}),e.jsx(o,{variant:"h4",children:w})]}),e.jsxs(p,{sx:{p:2,textAlign:"center",flex:1},children:[e.jsx(o,{variant:"h6",children:"Applications Received"}),e.jsx(o,{variant:"h4",children:I})]})]}),e.jsxs(p,{sx:{p:2,mb:3},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Job and Application Summary"}),e.jsx(c,{display:"flex",justifyContent:"center",children:e.jsxs(Q,{width:400,height:400,children:[e.jsx(V,{data:P,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percent:s})=>`${t} ${(s*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:P.map((t,s)=>e.jsx(X,{fill:S[s%S.length]},`cell-${s}`))}),e.jsx(Y,{}),e.jsx(Z,{verticalAlign:"bottom",align:"center"})]})})]}),e.jsxs(p,{sx:{p:2},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Jobs Posted"}),e.jsx(b,{children:x.length>0?x.map(t=>e.jsxs(v,{divider:!0,children:[e.jsx(y,{primary:e.jsx(g,{to:`/job/${t.id}`,style:{textDecoration:"none",color:"inherit"},children:t.title}),secondary:`Posted on: ${new Date(t.posted_at).toLocaleDateString()}`}),e.jsx(A,{component:g,to:`/job/${t.id}`,edge:"end",children:e.jsx(D,{})})]},t.id)):e.jsx(o,{children:"No jobs posted within the selected date range."})})]}),e.jsxs(p,{sx:{p:2,mt:3},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Applications Received"}),e.jsx(b,{children:m.length>0?m.map(t=>{var s,a,n,l,h;return e.jsxs(v,{divider:!0,children:[e.jsx(ie,{alt:((a=(s=t.job_seeker)==null?void 0:s.user)==null?void 0:a.full_name)||"Unknown",src:(n=t.job_seeker)!=null&&n.profile_photo?`http://localhost:8000${t.job_seeker.profile_photo}`:void 0}),e.jsx(y,{primary:`Applicant: ${((h=(l=t.job_seeker)==null?void 0:l.user)==null?void 0:h.full_name)||"Unknown"}`,secondary:`Applied on: ${new Date(t.applied_at).toLocaleDateString()}`,sx:{marginLeft:2}}),e.jsx(A,{component:g,to:`/applicant/${t.id}`,edge:"end",children:e.jsx(D,{})})]},t.id)}):e.jsx(o,{children:"No applications received within the selected date range."})})]}),e.jsxs(p,{sx:{p:2,mt:3},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Upcoming Interviews"}),e.jsxs(b,{children:[m.flatMap(t=>t.job_seeker.interview_schedule.filter(s=>r(s.scheduled_time).isAfter(r())||r(s.scheduled_time).isSame(r(),"day")).map(s=>{var n,l;const a=(l=(n=t.job_seeker.myapplications)==null?void 0:n.find(h=>h.id===s.job_application))==null?void 0:l.job_details;return e.jsx(v,{divider:!0,children:e.jsxs(C,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(C,{item:!0,xs:12,md:8,children:e.jsx(y,{primary:`Interview for ${t.job_seeker.user.full_name}`,secondary:`Job: ${a?a.title:"Unknown Job"} | Scheduled: ${new Date(s.scheduled_time).toLocaleString()} | Location: ${s.location||"TBD"}`})}),e.jsx(C,{item:!0,xs:12,md:4,children:e.jsxs(o,{variant:"body2",children:["Duration: ",s.duration?`${s.duration}`:"Not Specified"]})})]})},s.id)})),m.length===0&&e.jsx(o,{children:"No upcoming interviews found."})]})]}),e.jsxs(p,{sx:{p:2,mt:3},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Job Performance"}),e.jsx(b,{children:U.map(t=>e.jsxs(v,{divider:!0,children:[e.jsx(y,{primary:`Job: ${t.title}`,secondary:`Applications: ${t.applicationsCount}`}),e.jsx(A,{component:g,to:`/job/${t.id}`,edge:"end",children:e.jsx(D,{})})]},t.id))})]})]})]})})};export{Te as default};
