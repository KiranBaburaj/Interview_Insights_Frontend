import{aH as r}from"./index-DZZwBIMF.js";let n=0;const f=5,l=(i,c,a)=>{if(t&&t.readyState===WebSocket.OPEN)return console.warn("Notification WebSocket already connected."),t;const t=new WebSocket(`wss://www.interviewinsights.site/ws/notifications/${c}/?token=${i}`);return t.onopen=()=>{console.log("Notification WebSocket connection established."),n=0},t.onmessage=e=>{try{const o=JSON.parse(e.data);if(console.log("WebSocket message:",o),o.notification){const s={id:o.notification.id,message:o.notification.message,is_read:o.notification.is_read,user:o.notification.user_id,notification_type:o.notification.notification_type,created_at:o.notification.timestamp};a(r(s)),console.log("Dispatched notification:",s)}}catch(o){console.error("Failed to parse notification WebSocket message:",o)}},t.onerror=e=>{console.error("Notification WebSocket error:",e)},t.onclose=e=>{console.log("Notification WebSocket connection closed:",e),n<f?setTimeout(()=>{n++,console.log(`Reconnection attempt ${n}...`),l(i,c,a)},5e3):console.error("Max reconnect attempts reached. Could not reconnect.")},t},m=i=>{console.warn("Notification WebSocket is not connected.")};export{l as c,m as s};
