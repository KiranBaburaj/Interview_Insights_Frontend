import{j as e,u as G,r as f,b as d,k as M,m as z,n as O,L as g}from"./index-CRzLas2F.js";import{E as K}from"./EmployerNavbar-BjJ8S_Kt.js";import{d as i,L as W,A as q,D as H,P as Q,a as V,C as X,T as Y,b as Z}from"./AdapterDayjs-DBUDgyMz.js";import{d as ee,B as c,T as r}from"./Box-B0K2Utfq.js";import{C as te}from"./CircularProgress-CNQ5GFDX.js";import{C as se,L as y}from"./ListItemText-DmNWE0je.js";import{T as re}from"./ExitToApp-B0jtH8W1.js";import{C as ie}from"./CalendarToday-CebdnG7f.js";import{P as p,L as b}from"./List-DD5UVASD.js";import{L as v}from"./ListItem-CYvlGmse.js";import{I as A}from"./IconButton-BVhat7y2.js";import{A as oe}from"./Avatar-CLGAdN82.js";import{G as C}from"./Grid-CdET5nDX.js";import"./Business-hOOL0IKo.js";import"./NotificationList-C_sDZJ6v.js";import"./notificationWebSocket-DcUkuwoo.js";import"./MenuItem-D-4dKH7s.js";import"./dividerClasses-DEdHJ5Qa.js";import"./listItemTextClasses-Clbjgp3D.js";import"./TextField-BESo6vYX.js";import"./Snackbar-q5xzs782.js";import"./useMediaQuery-C4_lcFhi.js";import"./useThemeProps-Dzu_8_ZB.js";import"./Divider-BEg1yfDw.js";import"./isBetween-DzsoH6it.js";import"./Button-D6UGBtCL.js";import"./Stack-D0LIR25t.js";import"./visuallyHidden-Dan1xhjv.js";import"./DialogContent-TjqD1Y5F.js";import"./Chip-Dg4BJD_i.js";import"./useSlot-B6fU6xDy.js";const D=ee(e.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos"),P=["#0088FE","#00C49F","#FFBB28","#FF8042"],Ee=()=>{const x=G(),[L,S]=f.useState(!1),[o,k]=f.useState([null,null]),{user:B}=d(t=>t.auth),{userid:J}=d(t=>t.auth),_=J;console.log(_);const j=d(M),F=d(t=>t.applicants.applicants),T=d(t=>t.jobs.status),E=d(t=>t.applicants.status),{full_name:R}=d(t=>t.auth);f.useEffect(()=>{x(z())},[x]),f.useEffect(()=>{j.length>0&&!L&&(j.forEach(t=>{x(O(t.id))}),S(!0))},[x,j,L]);const N=t=>{k(t)},u=j.filter(t=>{const s=i(t.posted_at);return t.employer===_&&(!o[0]||s.isAfter(i(o[0]).subtract(1,"day")))&&(!o[1]||s.isBefore(i(o[1]).add(1,"day")))}),m=F.filter(t=>{const s=i(t.applied_at);return t.job_details.employer==_&&(!o[0]||s.isAfter(i(o[0]).subtract(1,"day")))&&(!o[1]||s.isBefore(i(o[1]).add(1,"day")))}),$=u.length,w=m.length,I=[{name:"Jobs Posted",value:$},{name:"Applications Received",value:w}];if(T==="loading"||E==="loading")return e.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(te,{})});const U=u.map(t=>{const s=m.filter(l=>l.job_seeker.myapplications.some(h=>h.job===t.id)),a=t.views_count||0,n=s.length;return{id:t.id,title:t.title,viewsCount:a,applicationsCount:n}});return e.jsx(W,{dateAdapter:q,children:e.jsxs(c,{sx:{display:"flex"},children:[e.jsx(se,{}),e.jsx(K,{}),e.jsxs(c,{component:"main",sx:{flexGrow:1,p:3,width:{sm:"calc(100% - 240px)"}},children:[e.jsx(re,{}),e.jsxs(c,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsxs(r,{variant:"h4",component:"h1",children:["Welcome, ",B?R:"Employer"]}),e.jsxs(c,{display:"flex",alignItems:"center",children:[e.jsx(ie,{}),e.jsx(H,{sx:{mx:2},startText:"Start",endText:"End",value:o,onChange:N})]})]}),e.jsxs(c,{display:"flex",justifyContent:"space-between",mb:3,children:[e.jsxs(p,{sx:{p:2,textAlign:"center",flex:1,mr:2},children:[e.jsx(r,{variant:"h6",children:"Total Jobs Posted"}),e.jsx(r,{variant:"h4",children:$})]}),e.jsxs(p,{sx:{p:2,textAlign:"center",flex:1},children:[e.jsx(r,{variant:"h6",children:"Applications Received"}),e.jsx(r,{variant:"h4",children:w})]})]}),e.jsxs(p,{sx:{p:2,mb:3},children:[e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Job and Application Summary"}),e.jsx(c,{display:"flex",justifyContent:"center",children:e.jsxs(Q,{width:400,height:400,children:[e.jsx(V,{data:I,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percent:s})=>`${t} ${(s*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:I.map((t,s)=>e.jsx(X,{fill:P[s%P.length]},`cell-${s}`))}),e.jsx(Y,{}),e.jsx(Z,{verticalAlign:"bottom",align:"center"})]})})]}),e.jsxs(p,{sx:{p:2},children:[e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Jobs Posted"}),e.jsx(b,{children:u.length>0?u.map(t=>e.jsxs(v,{divider:!0,children:[e.jsx(y,{primary:e.jsx(g,{to:`/job/${t.id}`,style:{textDecoration:"none",color:"inherit"},children:t.title}),secondary:`Posted on: ${new Date(t.posted_at).toLocaleDateString()}`}),e.jsx(A,{component:g,to:`/job/${t.id}`,edge:"end",children:e.jsx(D,{})})]},t.id)):e.jsx(r,{children:"No jobs posted within the selected date range."})})]}),e.jsxs(p,{sx:{p:2,mt:3},children:[e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Applications Received"}),e.jsx(b,{children:m.length>0?m.map(t=>{var s,a,n,l,h;return e.jsxs(v,{divider:!0,children:[e.jsx(oe,{alt:((a=(s=t.job_seeker)==null?void 0:s.user)==null?void 0:a.full_name)||"Unknown",src:(n=t.job_seeker)!=null&&n.profile_photo?`http://localhost:8000${t.job_seeker.profile_photo}`:void 0}),e.jsx(y,{primary:`Applicant: ${((h=(l=t.job_seeker)==null?void 0:l.user)==null?void 0:h.full_name)||"Unknown"}`,secondary:`Applied on: ${new Date(t.applied_at).toLocaleDateString()}`,sx:{marginLeft:2}}),e.jsx(A,{component:g,to:`/applicant/${t.id}`,edge:"end",children:e.jsx(D,{})})]},t.id)}):e.jsx(r,{children:"No applications received within the selected date range."})})]}),e.jsxs(p,{sx:{p:2,mt:3},children:[e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Upcoming Interviews"}),e.jsxs(b,{children:[m.flatMap(t=>t.job_seeker.interview_schedule.filter(s=>i(s.scheduled_time).isAfter(i())||i(s.scheduled_time).isSame(i(),"day")).map(s=>{var n,l;const a=(l=(n=t.job_seeker.myapplications)==null?void 0:n.find(h=>h.id===s.job_application))==null?void 0:l.job_details;return e.jsx(v,{divider:!0,children:e.jsxs(C,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(C,{item:!0,xs:12,md:8,children:e.jsx(y,{primary:`Interview for ${t.job_seeker.user.full_name}`,secondary:`Job: ${a?a.title:"Unknown Job"} | Scheduled: ${new Date(s.scheduled_time).toLocaleString()} | Location: ${s.location||"TBD"}`})}),e.jsx(C,{item:!0,xs:12,md:4,children:e.jsxs(r,{variant:"body2",children:["Duration: ",s.duration?`${s.duration}`:"Not Specified"]})})]})},s.id)})),m.length===0&&e.jsx(r,{children:"No upcoming interviews found."})]})]}),e.jsxs(p,{sx:{p:2,mt:3},children:[e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Job Performance"}),e.jsx(b,{children:U.map(t=>e.jsxs(v,{divider:!0,children:[e.jsx(y,{primary:`Job: ${t.title}`,secondary:`Applications: ${t.applicationsCount}`}),e.jsx(A,{component:g,to:`/job/${t.id}`,edge:"end",children:e.jsx(D,{})})]},t.id))})]})]})]})})};export{Ee as default};
